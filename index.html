<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Jackie's Curse Counter</title>
  <style>
    /* [Keep all your existing CSS styles] */
  </style>
</head>
<body>
  <!-- [Keep all your existing HTML structure] -->

  <script>
    // Webhook URL
    const webhookURL = "https://discord.com/api/webhooks/1378646229256241222/6BllgbinjkqsWmYFl7Chop-RGRUdTGOjwiPrOVZxenAMKGCrI3ziok791OPVjL9qXBJZ";

    const curseWords = [
      { label: "f*ck", full: "fuck" },
      { label: "sh*t", full: "shit" },
      { label: "b*tch", full: "bitch" },
      { label: "a**", full: "ass" },
      { label: "d*ck", full: "dick" },
      { label: "r-word", full: "rape" },
      { label: "slur-HR", full: "Hard R" },
      { label: "slur-SR", full: "Soft R" },
      { label: "G-slur", full: "a general slur" }
    ];

    // DOM elements
    const todayCountEl = document.getElementById("todayCount");
    const totalCountEl = document.getElementById("totalCount");
    const todayBoardEl = document.getElementById("todayBoard");
    const allTimeBoardEl = document.getElementById("allTimeBoard");

    // Improved date handling
    function getTodayKey() {
      const now = new Date();
      return now.toISOString().split('T')[0]; // YYYY-MM-DD format
    }

    // Initialize or load data with proper structure
    function initializeData() {
      const todayKey = getTodayKey();
      let data = JSON.parse(localStorage.getItem("curseData")) || {
        total: 0,
        days: {},
        allTime: { words: {} }
      };

      // Ensure days object exists
      if (!data.days) data.days = {};
      
      // Initialize today's data if missing or if date changed
      if (!data.days[todayKey] || typeof data.days[todayKey] !== 'object') {
        data.days[todayKey] = {
          count: 0,
          words: {}
        };
      }

      // Ensure allTime words object exists
      if (!data.allTime || typeof data.allTime !== 'object') {
        data.allTime = { words: {} };
      }
      if (!data.allTime.words || typeof data.allTime.words !== 'object') {
        data.allTime.words = {};
      }

      return data;
    }

    let data = initializeData();
    const todayKey = getTodayKey();

    // Save data to localStorage
    function saveData() {
      localStorage.setItem("curseData", JSON.stringify(data));
      updateUI();
    }

    // [Rest of your functions remain the same: updateUI, updateLeaderboard, handleCurse, etc.]

    // Create buttons
    function createButtons() {
      const buttonContainer = document.getElementById('buttons');
      if (!buttonContainer) return;
      
      buttonContainer.innerHTML = '';
      
      curseWords.forEach(wordObj => {
        const btn = document.createElement('button');
        btn.className = 'curse-btn';
        btn.textContent = wordObj.label;
        btn.setAttribute('data-word', wordObj.full);
        btn.onclick = () => handleCurse(wordObj);
        buttonContainer.appendChild(btn);
      });
    }

    // Initialize the app
    window.onload = function() {
      // Ensure data is properly initialized
      data = initializeData();
      saveData(); // Save any initialized structure
      
      createButtons();
      updateUI();
    };
  </script>
</body>
</html>
